# æ€§èƒ½ä¸‹é™åŸå› åˆ†æä¸ä¿®å¤

## ğŸ“Š é—®é¢˜ç°è±¡

ä½¿ç”¨ `data/full` æ•°æ®è¿è¡Œ `context_before` å®éªŒåï¼ŒMRR ä» **0.3428** ä¸‹é™åˆ° **0.2702**ï¼Œä¸‹é™äº† **21.2%**ã€‚

## ğŸ” æ ¹æœ¬åŸå› 

### 1. **ç´¢å¼•æ–‡æ¡£æ•°ä¸¥é‡ä¸è¶³** âš ï¸ **å…³é”®é—®é¢˜**

**é—®é¢˜**ï¼š
- ä¹‹å‰çš„ä»£ç åªç´¢å¼•äº† **positive candidates**ï¼ˆ620ä¸ªæ–‡æ¡£ï¼‰
- ä½†å®é™…å€™é€‰æ–‡æ¡£æ€»æ•°æ˜¯ **4504ä¸ª**
- **åªç´¢å¼•äº† 13.8% çš„æ–‡æ¡£**ï¼

**å½±å“**ï¼š
- æ£€ç´¢æ—¶æ— æ³•æ‰¾åˆ°å¤§éƒ¨åˆ†å€™é€‰æ–‡æ¡£
- å³ä½¿æ¨¡å‹é¢„æµ‹æ­£ç¡®ï¼Œå¦‚æœæ–‡æ¡£ä¸åœ¨ç´¢å¼•ä¸­ï¼Œä¹Ÿæ— æ³•è¿”å›
- å¯¼è‡´ MRR å’Œ Recall å¤§å¹…ä¸‹é™

**ä¿®å¤**ï¼š
- âœ… å·²ä¿®æ”¹ `run_all_experiments.py` çš„ç´¢å¼•æ„å»ºé€»è¾‘
- âœ… ç°åœ¨ä¼šç´¢å¼•**æ‰€æœ‰ candidates**ï¼ˆåŒ…æ‹¬ positive å’Œ negativeï¼‰
- âœ… ç´¢å¼•æ–‡æ¡£æ•°ä» 620 å¢åŠ åˆ° 4504

### 2. å…¶ä»–å› ç´ ï¼ˆæ¬¡è¦ï¼‰

#### æ•°æ®é‡å·®å¼‚
- `fast_experiment`: 472 ä¸ªæ ·æœ¬
- `data/full`: 1888 ä¸ªæ ·æœ¬ï¼ˆ4å€ï¼‰
- æ›´å¤šæ ·æœ¬å¯èƒ½åŒ…å«æ›´å¤šå›°éš¾æ¡ˆä¾‹

#### è´Ÿæ ·æœ¬æ¯”ä¾‹
- `data/full`: 1:99ï¼ˆæ¯ä¸ª positive æœ‰ 99 ä¸ª negativesï¼‰
- `fast_experiment`: 1:20ï¼ˆæ¯ä¸ª positive æœ‰ 20 ä¸ª negativesï¼‰
- æ›´é«˜çš„è´Ÿæ ·æœ¬æ¯”ä¾‹ä½¿ä»»åŠ¡æ›´éš¾

#### æŸ¥è¯¢é•¿åº¦
- ä½¿ç”¨ `context_before` åï¼ŒæŸ¥è¯¢å¹³å‡é•¿åº¦ï¼š586 å­—ç¬¦
- æœ€å¤§é•¿åº¦ï¼š1354 å­—ç¬¦
- å¯èƒ½å¯¼è‡´ï¼š
  - æ¨¡å‹æˆªæ–­é—®é¢˜
  - å™ªå£°å¢åŠ 
  - æ€§èƒ½è½»å¾®ä¸‹é™

## âœ… ä¿®å¤å†…å®¹

### ä¿®æ”¹æ–‡ä»¶ï¼š`scripts/run_all_experiments.py`

**ä¹‹å‰**ï¼ˆé”™è¯¯ï¼‰ï¼š
```python
# åªç´¢å¼• positive candidates
for candidate in candidates:
    if candidate.get("label", 0) == 1:
        # åªæ·»åŠ  positive
        documents.append(target)
        break
```

**ç°åœ¨**ï¼ˆæ­£ç¡®ï¼‰ï¼š
```python
# ç´¢å¼•æ‰€æœ‰ candidatesï¼ˆåŒ…æ‹¬ positive å’Œ negativeï¼‰
for candidate in candidates:
    doc_id = candidate.get("arxiv_id", "")
    if doc_id and doc_id not in seen_ids:
        documents.append(doc)
        seen_ids.add(doc_id)
```

## ğŸ“ˆ é¢„æœŸæ”¹è¿›

ä¿®å¤åï¼Œé¢„æœŸæ€§èƒ½ï¼š

| æŒ‡æ ‡ | ä¿®å¤å‰ | é¢„æœŸä¿®å¤å | æ”¹è¿› |
|------|--------|-----------|------|
| MRR | 0.2702 | **0.32-0.35** | +18-30% |
| Recall@10 | 0.4878 | **0.55-0.60** | +13-23% |
| Recall@20 | 0.6065 | **0.65-0.70** | +7-15% |

**åŸå› **ï¼š
- ç°åœ¨æ‰€æœ‰å€™é€‰æ–‡æ¡£éƒ½åœ¨ç´¢å¼•ä¸­
- æ¨¡å‹å¯ä»¥æ­£ç¡®æ£€ç´¢åˆ°å®ƒä»¬
- æ€§èƒ½åº”è¯¥æ¥è¿‘æˆ–è¶…è¿‡ `fast_experiment` çš„ç»“æœ

## ğŸš€ é‡æ–°è¿è¡Œå®éªŒ

ä¿®å¤åï¼Œè¯·é‡æ–°è¿è¡Œä¸‰ä¸ª context å®éªŒï¼š

```bash
# å®éªŒ1: ä»…å‰æ–‡
python scripts/run_all_experiments.py --experiment exp_6_1b_1_context_before --data_dir data/full

# å®éªŒ2: ä»…åæ–‡
python scripts/run_all_experiments.py --experiment exp_6_1b_2_context_after --data_dir data/full

# å®éªŒ3: å‰åæ–‡
python scripts/run_all_experiments.py --experiment exp_6_1b_3_context_both --data_dir data/full
```

## ğŸ“ ç»éªŒæ•™è®­

1. **ç´¢å¼•å®Œæ•´æ€§è‡³å…³é‡è¦**ï¼šå¿…é¡»ç´¢å¼•æ‰€æœ‰å€™é€‰æ–‡æ¡£ï¼Œè€Œä¸ä»…ä»…æ˜¯ positive
2. **æ•°æ®æ ¼å¼å·®å¼‚**ï¼šä¸åŒæ•°æ®æ ¼å¼éœ€è¦ä¸åŒçš„å¤„ç†é€»è¾‘
3. **æ€§èƒ½ä¸‹é™æ—¶å…ˆæ£€æŸ¥ç´¢å¼•**ï¼šç´¢å¼•æ–‡æ¡£æ•°ä¸è¶³æ˜¯å¸¸è§ä½†å®¹æ˜“è¢«å¿½è§†çš„é—®é¢˜

## ğŸ”„ å¯¹æ¯”ï¼šfast_experiment vs data/full

| ç‰¹æ€§ | fast_experiment | data/full |
|------|----------------|-----------|
| æ ·æœ¬æ•° | 472 | 1888 |
| å”¯ä¸€ target | 295 | 620 |
| å€™é€‰æ–‡æ¡£æ€»æ•° | ~4720 | 4504 |
| è´Ÿæ ·æœ¬æ¯”ä¾‹ | 1:20 | 1:99 |
| ç´¢å¼•æ–‡æ¡£æ•°ï¼ˆä¿®å¤å‰ï¼‰ | ~4720 | 620 âŒ |
| ç´¢å¼•æ–‡æ¡£æ•°ï¼ˆä¿®å¤åï¼‰ | ~4720 | 4504 âœ… |
| æŸ¥è¯¢é•¿åº¦ | ~100 å­—ç¬¦ | ~586 å­—ç¬¦ï¼ˆwith contextï¼‰ |

